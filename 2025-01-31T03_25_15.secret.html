<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="PrivacyProtect" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="description"
      content="Securely share secrets and passwords over text messages, send end-to-end encrypted emails, or store password-protected files on USB and cloud drives."
    />
    <meta property="og:title" content="PrivacyProtect - Reveal secret" />
    <meta
      property="og:description"
      content="Securely share secrets and passwords over text messages, send end-to-end encrypted emails, or store password-protected files on USB and cloud drives."
    />
    <meta property="og:image" content="https://www.privacyprotect.dev/og.png" />
    <meta property="og:image:alt" content="PrivacyProtect" />
    <!-- CANONICAL -->
    <link rel="icon" href="https://www.privacyprotect.dev/favicon.svg" />
    <title>PrivacyProtect - Reveal secret</title>
    <style>
      /*! tailwindcss v3.3.5 | MIT License | https://tailwindcss.com*/*,:after,:before{box-sizing:border-box;border:0 solid #e5e7eb}:after,:before{--tw-content:""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:initial}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:initial;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:initial}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}[multiple],[type=date],[type=datetime-local],[type=email],[type=month],[type=number],[type=password],[type=search],[type=tel],[type=text],[type=time],[type=url],[type=week],input:where(:not([type])),select,textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-color:#6b7280;border-width:1px;border-radius:0;padding:.5rem .75rem;font-size:1rem;line-height:1.5rem;--tw-shadow:0 0 #0000}[multiple]:focus,[type=date]:focus,[type=datetime-local]:focus,[type=email]:focus,[type=month]:focus,[type=number]:focus,[type=password]:focus,[type=search]:focus,[type=tel]:focus,[type=text]:focus,[type=time]:focus,[type=url]:focus,[type=week]:focus,input:where(:not([type])):focus,select:focus,textarea:focus{outline:2px solid #0000;outline-offset:2px;--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);border-color:#2563eb}input::-moz-placeholder,textarea::-moz-placeholder{color:#6b7280;opacity:1}input::placeholder,textarea::placeholder{color:#6b7280;opacity:1}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-date-and-time-value{min-height:1.5em;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-meridiem-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-year-field{padding-top:0;padding-bottom:0}select{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem;-webkit-print-color-adjust:exact;print-color-adjust:exact}[multiple],[size]:where(select:not([size="1"])){background-image:none;background-position:0 0;background-repeat:unset;background-size:initial;padding-right:.75rem;-webkit-print-color-adjust:unset;print-color-adjust:unset}[type=checkbox],[type=radio]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;-webkit-print-color-adjust:exact;print-color-adjust:exact;display:inline-block;vertical-align:middle;background-origin:border-box;-webkit-user-select:none;-moz-user-select:none;user-select:none;flex-shrink:0;height:1rem;width:1rem;color:#2563eb;background-color:#fff;border-color:#6b7280;border-width:1px;--tw-shadow:0 0 #0000}[type=checkbox]{border-radius:0}[type=radio]{border-radius:100%}[type=checkbox]:focus,[type=radio]:focus{outline:2px solid #0000;outline-offset:2px;--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:2px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}[type=checkbox]:checked,[type=radio]:checked{border-color:#0000;background-color:currentColor;background-size:100% 100%;background-position:50%;background-repeat:no-repeat}[type=checkbox]:checked{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 16 16'%3E%3Cpath d='M12.207 4.793a1 1 0 0 1 0 1.414l-5 5a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L6.5 9.086l4.293-4.293a1 1 0 0 1 1.414 0z'/%3E%3C/svg%3E")}[type=radio]:checked{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 16 16'%3E%3Ccircle cx='8' cy='8' r='3'/%3E%3C/svg%3E")}[type=checkbox]:checked:focus,[type=checkbox]:checked:hover,[type=checkbox]:indeterminate,[type=radio]:checked:focus,[type=radio]:checked:hover{border-color:#0000;background-color:currentColor}[type=checkbox]:indeterminate{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 16 16'%3E%3Cpath stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8h8'/%3E%3C/svg%3E");background-size:100% 100%;background-position:50%;background-repeat:no-repeat}[type=checkbox]:indeterminate:focus,[type=checkbox]:indeterminate:hover{border-color:#0000;background-color:currentColor}[type=file]{background:unset;border-color:inherit;border-width:0;border-radius:0;padding:0;font-size:unset;line-height:inherit}[type=file]:focus{outline:1px solid ButtonText;outline:1px auto -webkit-focus-ring-color}*,::backdrop,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-top:1.2em;margin-bottom:1.2em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);text-decoration:underline;font-weight:500}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal;margin-top:1.25em;margin-bottom:1.25em;padding-left:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:disc;margin-top:1.25em;margin-bottom:1.25em;padding-left:1.625em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{font-weight:400;color:var(--tw-prose-counters)}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.25em}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:500;font-style:italic;color:var(--tw-prose-quotes);border-left-width:.25rem;border-left-color:var(--tw-prose-quote-borders);quotes:"\201C""\201D""\2018""\2019";margin-top:1.6em;margin-bottom:1.6em;padding-left:1em}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:900;color:inherit}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:800;color:inherit}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.5em;margin-bottom:.5em;line-height:1.5}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){display:block;margin-top:2em;margin-bottom:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:500;font-family:inherit;color:var(--tw-prose-kbd);box-shadow:0 0 0 1px rgb(var(--tw-prose-kbd-shadows)/10%),0 3px 0 rgb(var(--tw-prose-kbd-shadows)/10%);font-size:.875em;border-radius:.3125rem;padding:.1875em .375em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-weight:600;font-size:.875em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-pre-code);background-color:var(--tw-prose-pre-bg);overflow-x:auto;font-weight:400;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:initial;border-width:0;border-radius:0;padding:0;font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){width:100%;table-layout:auto;text-align:left;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.7142857}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-th-borders)}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;vertical-align:bottom;padding-right:.5714286em;padding-bottom:.5714286em;padding-left:.5714286em}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-td-borders)}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:initial}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-width:1px;border-top-color:var(--tw-prose-th-borders)}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-kbd:#111827;--tw-prose-kbd-shadows:17 24 39;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.375em}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(.prose>ul>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-left:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-right:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-right:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.prose-emerald{--tw-prose-links:#059669;--tw-prose-invert-links:#10b981}.relative{position:relative}.z-10{z-index:10}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.my-6{margin-top:1.5rem;margin-bottom:1.5rem}.-ml-px{margin-left:-1px}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-4{height:1rem}.max-h-96{max-height:24rem}.w-10{width:2.5rem}.w-4{width:1rem}.w-full{width:100%}.max-w-3xl{max-width:48rem}.max-w-none{max-width:none}.flex-1{flex:1 1 0%}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.resize-none{resize:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.gap-2{gap:.5rem}.gap-x-4{-moz-column-gap:1rem;column-gap:1rem}.gap-y-4{row-gap:1rem}.overflow-hidden{overflow:hidden}.overflow-x-hidden{overflow-x:hidden}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-l-md{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.rounded-r-md{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.border{border-width:1px}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity))}.border-transparent{border-color:#0000}.bg-emerald-700{--tw-bg-opacity:1;background-color:rgb(4 120 87/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-5{padding-bottom:1.25rem}.pt-5,.py-5{padding-top:1.25rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-medium{font-weight:500}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.input-border{--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity))}.input-border:focus{--tw-border-opacity:1;border-color:rgb(16 185 129/var(--tw-border-opacity));--tw-ring-opacity:1;--tw-ring-color:rgb(16 185 129/var(--tw-ring-opacity))}.input-error{--tw-border-opacity:1;border-color:rgb(252 165 165/var(--tw-border-opacity))}.input-error:focus{--tw-border-opacity:1;border-color:rgb(239 68 68/var(--tw-border-opacity));--tw-ring-opacity:1;--tw-ring-color:rgb(239 68 68/var(--tw-ring-opacity))}.focus-within\:z-10:focus-within{z-index:10}.hover\:bg-emerald-800:hover{--tw-bg-opacity:1;background-color:rgb(6 95 70/var(--tw-bg-opacity))}.hover\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.hover\:text-emerald-600:hover{--tw-text-opacity:1;color:rgb(5 150 105/var(--tw-text-opacity))}.focus\:border-emerald-500:focus{--tw-border-opacity:1;border-color:rgb(16 185 129/var(--tw-border-opacity))}.focus\:outline-none:focus{outline:2px solid #0000;outline-offset:2px}.focus\:ring-1:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color)}.focus\:ring-1:focus,.focus\:ring-2:focus{box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color)}.focus\:ring-emerald-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(16 185 129/var(--tw-ring-opacity))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:bg-gray-600:disabled{--tw-bg-opacity:1;background-color:rgb(75 85 99/var(--tw-bg-opacity))}@media (min-width:640px){.sm\:col-span-6{grid-column:span 6/span 6}.sm\:grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}}
    </style>
    <script>
      
  var __defProp = Object.defineProperty;
  var __defProps = Object.defineProperties;
  var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
  var __getOwnPropSymbols = Object.getOwnPropertySymbols;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __propIsEnum = Object.prototype.propertyIsEnumerable;
  var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
  var __spreadValues = (a, b) => {
    for (var prop in b || (b = {}))
      if (__hasOwnProp.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    if (__getOwnPropSymbols)
      for (var prop of __getOwnPropSymbols(b)) {
        if (__propIsEnum.call(b, prop))
          __defNormalProp(a, prop, b[prop]);
      }
    return a;
  };
  var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));

  // src/lib/decrypt.ts
  function decrypt(req) {
    const config2 = {
      encryptionAlgo: req.encryptionAlgo,
      hash: req.hash,
      iterations: req.iterations,
      keyDerivationAlgo: req.keyDerivationAlgo,
      keyLen: req.keyLen
    };
    return Promise.all(
      req.payloads.map(async (payload) => {
        let cipherText;
        try {
          cipherText = await decryptOne(__spreadProps(__spreadValues({}, config2), {
            payload,
            subtle: req.subtle
          }));
        } catch (error) {
        }
        return {
          cipherText,
          fileExtension: payload.fileExtension,
          secretType: payload.secretType
        };
      })
    );
  }
  async function decryptOne(req) {
    const importedKey = await req.subtle.importKey(
      "raw",
      new TextEncoder().encode(req.payload.password),
      { name: req.keyDerivationAlgo },
      false,
      ["deriveKey"]
    );
    const derivedKey = await req.subtle.deriveKey(
      {
        hash: req.hash,
        iterations: req.iterations,
        name: req.keyDerivationAlgo,
        salt: req.payload.salt
      },
      importedKey,
      { length: req.keyLen * 8, name: req.encryptionAlgo },
      false,
      ["decrypt"]
    );
    return req.subtle.decrypt(
      { iv: req.payload.iv, name: req.encryptionAlgo },
      derivedKey,
      req.payload.cipherText
    );
  }

  // src/lib/mappers.ts
  var IMG_EXTS = ["jpg", "jpeg", "png", "gif", "webp"];
  function arrayBufToStr(buf) {
    return new TextDecoder().decode(buf);
  }
  function toFileName(fileExtension) {
    const fe = fileExtension != null ? fileExtension : "";
    const ext = fe ? ".".concat(fe) : "";
    return {
      ext: fe,
      isImg: IMG_EXTS.includes(fe),
      name: "privacyprotect".concat(ext)
    };
  }

  // src/lib/constants.ts
  var SECRET_TYPES = { message: "Message", file: "File" };
  var secretTypes = Object.values(SECRET_TYPES);
  function isString(val) {
    return typeof val === "string" || val instanceof String;
  }

  // src/lib/template-secret.ts
  function strToConfig(payload) {
    try {
      if (!payload)
        return void 0;
      const config2 = isString(payload) ? JSON.parse(payload) : payload;
      return __spreadProps(__spreadValues({}, config2), {
        payloads: config2.payloads.map(payloadToCipherPayload)
      });
    } catch (error) {
      return void 0;
    }
  }
  function payloadToCipherPayload(payload) {
    return __spreadProps(__spreadValues({}, payload), {
      cipherText: hexStrToBytes(payload.cipherText),
      iv: hexStrToBytes(payload.iv),
      salt: hexStrToBytes(payload.salt)
    });
  }
  function hexStrToBytes(hex) {
    const bytes = [];
    for (let c = 0; c < hex.length; c += 2) {
      bytes.push(parseInt(hex.substring(c, c + 2), 16));
    }
    return Uint8Array.from(bytes);
  }

  // src/lib/validators.ts
  function nonNull(value) {
    return value != null;
  }

  // src/lib/template.ts
  var CONFIG = `{"encryptionAlgo":"AES-GCM","hash":"SHA-512","iterations":2100000,"keyDerivationAlgo":"PBKDF2","keyLen":32,"passwordHint":"Password is the iphone number related to this case.","payloads":[{"cipherText":"f9b20e9da795cb5f21769b7c493d8f9f096af198c185b3111a67cdc6c6a3e37ca6075d842208e361e13e2a59b384f7cdbb7f0657ffaa576f495a293c5746e82495d2170e5bbddaa080d71911dd47494bfeb1d05c37f57f9364c84e097dac5e8b5d6d5544926bc478d8461ca3af61e57896c11a132ce0eb858360bab385971b8a12ef1c0cac5cc8a9848dda65ff97285ed24c3dae210edd93ce7ec960bae595b15f0d398a222acbd4ae98ebfba3d6f6af2a3f3cc447e8749f41eba290d012853943f527801edd07ab6232fdba06a4fdeada032a6ed35b8291fa9e3bfaf05f653e7e129c31254f531a99eebfb16b12e62d35cc94ee8b60a3b947bba89056f38bc398d678eae800ec84b8cdb9715d7bc30ec15280b956b8ca8654418f5c4ebfb47764a8ee31ed2017a39538655dc4afd5b4e625518660d63b7ae45729bb97a6e04eaaabb595c6143c537e26474c7ddfab1033719d22a213985cc3b13bd9c8154e10b9c9120c79c839e147d9aa359fe7dbee5e38eba67695be6e063277265d7845985ef1977205061fc630621a4c6b7424a784fe779c8d174e0aef5e03f2bc4e3753f420b1356c347e5843b50432b847a6cfd1fef32902d1e6d28f7e3dc189096e9a53c2164d820f8c72e0242939bb9a4a93488ebdb793a2a590ef4abafc7c85dd5367910cbe2a47c4825bdce1ab54279f1f0a556db79ef08e660ace2dbb27fba65259d909a0951863eb84334a923a4b2110e207075e4a213b2c182d1b3ea18be8de330e11b08f0b2df85b2e2ea2b2f100c6f1dfb88a2bf648b396e53afd2a2b2af02c86851b36e07cd2c1b3093b5751d6a899230361a853c2b31218c4e0157854619f6c4e3d635fa7c2eb0e981e91ad909497431fef66d909d0d517f4bb1a9cf5d57138398340ff699236f05a0a82ca8a919d1d8c2392483e9f0373669a258dd1e27cfef33b8b2394e2845d29ff62be466819b7eda45d23d23317301fa6d696a06a1db3f9e5c09b4d48e9a733c7c6a1d88d0ada7eeaaaa0456fc8b8c0757312a12daae79f4623ad89955ce847831ec7a497c4b858c4c94398c2093fec3269f4f17fd6fdd253931074ff6db18d481025b1f6d44a4115c0b9c10dabe554f0cd787774a24854b1feb9c49a66bfd277fc1872cfbc7dabeea12a0566529b9867398437f28c8ac4732f96f700bf8f137fddd07d54350251c5139f0524b7db4d5f56773de7a8c13f536af7b06fe0a0b11fb87c4c8716ddf9d9ce3053b006401a6414bd67a3bcf068658b22af2ff24102642f234bc9a0a8c00844e2cd884d1793197504bb583d8a502e21721e5577217c7f01a12838b96195158c8d850f267178af1b3921ed5daddb2f4ba50f380acc88d30232751ac5258aa26c086295562fdd1f6e56316c2484fa755d143a488add31cb75ae5bc4618b21341eddaa17eeb2aed6aa7d6e9202bab8b9eed36a18f4ee894cef9ea93c5f18b0df308bd2149008253f501f1586e0ab817cd11be4d17ad9de1aea087dc2b5d375d9492a2c428ee8896df79e3ad2f1a79d5b0df906a2017464796ecc5d82b02a4c665713c72407679f508f8687f04751054e7e2d6d7ada46e7c8b15076b3f09d5e0873f5a71c262996bd92bfc11d05cd70a0c1ec469b4a6111be19f138bb9ba3083ead5b7be1aaab55f107490eb109a9849184e845c381512d867d695cb85fcfc0a2b4649c5b5991b84688e9f750d22344ce47cc18cc8afc8358983156a6665c07812171f8b67a59ca2f153f6d9df8f86f4212358c58e4997f108e9909c171816bfd3e47242933c3b9cde4a0091ae1f689e1af65e1c930ab9dd5fe3f8276d2eb5a6bfe5971b3c2f2f19d797a64c93685937dba1768e60793b88758ccc263a56484b92c549454306b34e7afde2ce11310c143d81d0cef084b1bfcdd28678777ce9666e4ac3e230c064e4be5c014ea272d8fd1e792d1971110393d0ad728ade9fb13ebf0ff54665ac81146d42deb25fe466858390c965852100da704302f9ac4d7cf3765abe858597af85be63f821502d2f306f54df71e3862e3af5cd7ac73c1c62b08983441a32df2685515e6215cb63f109d3b7ce0bf46ce335ea1517cdc8969b030550ab7ef443796d64b6a132eb15ddd8b0f6ff17110d4218ba296bc4ab673f91e7ffbb0bc9030f5ee17743fce1e6a99ddc4cf0727f2f4831a915c68cdc9c777701bc7c5251b8719ca79a4a8a77e873062dc4d904a4df6ca1f80702b5c7449125154b18f6d0d8c54f6ee252e5e2cce451cd9f5fa72ba9fd62a63993541b522aded3b8904d41c74037252c329d9776295cd29639661f2f6710b848d98607ebc3b63cd6eaabdbf9f214d654f9c4ee4783901d43aae28577dfea4c8a417d6b23acaeaf4ed744949f7c8af7aacbd564f4889652bc3bbf011070d9f26643843748d8697706be2cdb14ec54496e63110a65b700b133d8f049d9a34173aca56ab6f60f27d5a94025364e39c5afd46961145c249771b9026995fa9d6ef7a071dd5b97e48f6684dd4caf5d653f9dd907d052ca8a9002910f54c20272c988bd4f85214c549f5a30526993b527a55f3387f8bb11940e2e965c1aa8cb52f5e619d34adea7c251de0879d8f0225e1071ace8ba08ddaec0e869884e53232ecc7756f9d80e8af506baddb4b8e95d4530c92c276e112c6cf102403ce10a7b86d129d36fd331f5ba2307c0a3763db5473d583f70b174775e8875cd4d39a454c9b93d6cbac1d9b217d22c3a143676ffe9c0cd807f47cf3460ad3a1bddf791036b4b81c3de1175f6ed7994f3248c6e4a241cd0412cea025bdf14b355f2adf92ce4874c37277f7f3cea4b9ae59dff4f0c6cc45bb7bffbee398771030b66a9a6ae733a2a3f4b15b0272f22dccc816600ab0d5c8419183bba118cfc64293a69b7812d12b943af3f58ab1bfe558fd2e279f89ea83bf41bd5ba97cdfa2f0061b3935f6c38fc6ddc4e8b2caef49087a8b45272ed9a14cf21423a4d0713498e17394ba20b12f1b9729d2c61fbc66b1427fb161224b29fdcb658b9b044a54826b3add6b566cfeae437ddd2177af9ff53b9c99efc7df56f32858c73565f8468b9c84d933de741cdd91c70d24261381020f49381ce7da2a0642da02e3cbe8d949a508f170587d11a17347bd94c5840ca0b3b4f4d38230c90c647cc9860bc31819aa60cccf51fefbfedfa92ec06200262c30b758d00ca13a382f9e6f73cd8b798e422a548056768654d3dab1fe08c6d0fedc0ef55d32363fecd0ee5a2cf6a64cbdeb7ef2ef7791df06ae5cbcbf18fa04b7d2e2f18862d86a47e0049ba1268426887cbc91c5e74faf83c6e20f5da2293fa2348c9cd22208c21b96dac15b8193620eac6a3c38ec4ff2eac3a1844ef064887f3b8faf33412a2523061694ab1ae0b3a7e87c0b7d57e8d8998a55867f78c8590ba8dc35f4d809a0cee937ebdabca1e3ef6413afa494c32552bcee61578b760820001ffde6be18a7cfdacd305fa5f5b4b77581c811d27da7b0dd0f972b16bc716ee29d13b3715585db4d58eec4eddb37bdc3d880e940ea4ccfef57256be15c75a57f67ef1a9bd413373e159f1997394510935346d0fed750616da94340b1e74d21cdcf694b9cabc9290c16df411ed86be0ff656f757d5f0d6b064e79eeace6bdf8a34167c30d479e9c5b2f9fc402de053e39c9f9ecaff6817c711b8589733145d70cea90d2fa3a4c46c67997ddcdf9690a088ae90f938ef45a941c21d82630f3330b7162248646e22a738a5aad610ca057d68e651790821442fa13e5530149d870c4874a6372789982c565549a4e703ba839aa9a10a94e24e773ffef63da3df71d85b1a72a60eb60bb4ac0b740b7653645eaa0573d9bf08e5898d5e6288be27628faba50600643f235c68613ec4a4536a9db5be3bdd6c47f5535a3b3cfb324ff9b2c54aa54f7c6af7973d152de3ecfc2c30bad6cc99caea6280636485b991806e252c34ac8c077b93f3e55d02dd73c597f99f32a807767bd9564df084475dc89573039df018d91e9d87e2da5130afbd8ce929fc16ce213fb9e1f6b9b155161fbf6f375f275969b3713205d91c5e497d07422dcbead05dbdd61ba625a6bceafc1420f98b229c548af17b93a4869a51e6298f73fc7a781aa2670eef8f7418ed68f8179e719a29edd22a85fa62cdecf8afee6b373d62e7343849c01e47e16ec6cc9612b532ecffb04083f4216accbac7ecb16281dd54ba0fd26607abcdb43f6f263dc664feec5a65da61b05bd1bc432caa76ca0c4efbc11daf9a5e6380423f1a8939affc2f988894db14f3581f6495722240d09bdbfb59b2f9d7ac746defd5d1f87244e83dbb81e98c7272a2a5e10b1a402fc306d950d925e93bd0c302f2af04258ab7dd282701cf0cf12740cf775253a6275f4cd3951305bcd2ee6a45e3f6699affe530176120e20cc8331ebc4c8739accf30b0fe4a8cb667c85adcc23b007daaf8fc77a38e87f57f67c6de1cbd52faa8bb81767df023f61c8092323c14a7032f6009a85bffb48a9acb4434c14278075df628274ffd45949f9b8a0f2ba5c94bed279d932dc30a0018a58ccd4931f4c301d3ea9cf928a2e993fe91582313a27211585676db7808510ea5b3352445106fae9aa32f0158bdfda4277e9ce80353b6ad7b59fc1e272bb1c1176bce098c78fe1b459ce647d991611338d73e633935b770ab7597587460c8877556f5dc616bb52f42143e1fb9c8b66fa112be770efca4e48f2c7e1a8e56a6bd305a7c5ef0a049fbb70826ac6a1dbc8373ce434a63d3bdf72559294afb5c56447c71e19d06b37db5b9603dee94a94d1f93c92bf6d9e9aae10d74572bf4c4c7e9daa9306cd4224fa82c69365a6792d391a8b093113c88ff7eb7ef308c318f50bfcaf9e5a0454dc1fb4b8143e3ed90cb5125c685d3132d4a32b0836966a404f01623f24acc15b950dc84a42d00ae0f4975b8a60e28cb7ffb0d50fddaa4ece5ca5dbb88cfb37adeafd7fa58f270ad021deaeed7a952d5472113e669f51238a0d3d14be26110e4b3c5efe92217102845ba0717d59d9ce400e6100cd0b42fe7c2ab9e8d8880282aeb5dfdc2f13072f8f311109c760b288d287fbbe81bf97d2011619077469155a59a4e23d7b528423a48c1eb250c0228d0c87791acc470b0bea58deecff80ef4f00a7625232bb6d45cfa174dd09b06dd90a42c2d77850b63be6c5eebc3faee591b3ca22d039a18893b60cd85d316c5b2d4e4d3595f2d9875cee2c55504c10","fileExtension":"txt","iv":"027292c15beffeb58358ba4257d7d9cf904e33c5c96514d56804e5274f6c04af","salt":"8ce53a1ebfafe64efa8edd45ae0fcbf82f628bf7e761f847b596e47bcdd35898","secretType":"File"}]}`;
  var CLS = {
    animate: "animate-pulse",
    hidden: "hidden",
    inputError: "input-error"
  };
  var ELS = {
    file: null,
    img: null,
    message: null,
    pw: null,
    pwError: null,
    pwHide: null,
    pwHint: null,
    pwHintDiv: null,
    pwShow: null,
    revealBtn: null,
    saveBtn: null
  };
  var els = ELS;
  var showPassword = false;
  var config;
  function init() {
    config = strToConfig(CONFIG);
    Object.keys(ELS).forEach((k) => {
      ELS[k] = document.getElementById(k);
    });
    if (config.passwordHint)
      els.pwHint.innerHTML = config.passwordHint;
    else
      els.pwHintDiv.classList.add(CLS.hidden);
    els.pw.addEventListener("keyup", (event) => {
      if (event.key === "Enter")
        revealSecret();
    });
    els.pw.addEventListener("input", () => {
      inputError(els.pw, els.pwError, "");
    });
  }
  function togglePwVisibility() {
    showPassword = !showPassword;
    if (showPassword) {
      els.pw.type = "text";
      els.pwShow.classList.add(CLS.hidden);
      els.pwHide.classList.remove(CLS.hidden);
    } else {
      els.pw.type = "password";
      els.pwShow.classList.remove(CLS.hidden);
      els.pwHide.classList.add(CLS.hidden);
    }
  }
  async function revealSecret(e) {
    const pw = els.pw.value;
    if (pw.length == 0)
      return;
    if (e != null)
      e.preventDefault();
    let res;
    try {
      setLoading(true);
      res = (await decrypt(__spreadProps(__spreadValues({}, config), {
        payloads: config.payloads.map((p) => __spreadProps(__spreadValues({}, p), { password: pw })),
        subtle: window.crypto.subtle
      }))).filter((r) => nonNull(r.cipherText))[0];
      els.pw.value = "";
    } catch (error) {
      inputError(els.pw, els.pwError, "Password invalid.");
      return;
    } finally {
      setLoading(false);
    }
    if (!res || !res.cipherText) {
      inputError(els.pw, els.pwError, "Password invalid.");
    } else if (res.secretType == "Message") {
      els.message.innerHTML = arrayBufToStr(res.cipherText);
    } else if (res.secretType == "File") {
      els.message.classList.add(CLS.hidden);
      const fn = toFileName(res.fileExtension);
      const content = new Uint8Array(res.cipherText).reduce(
        (a, b) => a + String.fromCharCode(b),
        ""
      );
      const b64 = btoa(content);
      const data = fn.isImg ? "data:image/".concat(fn.ext, ";base64,").concat(b64) : "data:application/octet-stream;base64,".concat(b64);
      els.saveBtn.classList.remove(CLS.hidden);
      els.saveBtn.innerHTML = "Save ".concat(fn.name);
      els.file.setAttribute("download", fn.name);
      els.file.setAttribute("href", data);
      if (fn.isImg) {
        els.img.setAttribute("src", data);
        els.img.classList.remove(CLS.hidden);
      }
    } else
      console.error("Invalid secret type ".concat(res.secretType));
  }
  function setLoading(loading) {
    els.revealBtn.disabled = loading;
    loading ? els.revealBtn.classList.add(CLS.animate) : els.revealBtn.classList.remove(CLS.animate);
  }
  function inputError(el, errorEl, error) {
    errorEl.innerHTML = error;
    error ? el.classList.add(CLS.inputError) : el.classList.remove(CLS.inputError);
  }


    </script>
  </head>
  <body onload="init()">
    <div class="mx-auto my-6 max-w-3xl overflow-x-hidden px-6">
      <header class="my-4">
        <a href="https://www.privacyprotect.dev/">
          <div class="flex gap-2 items-center">
            <svg
              class="h-10 w-10"
              viewBox="0 0 512 512"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M280 258.4V328c0 13.25-10.75 24-24 24s-24-10.75-24-24V258.4C213.1 249.4 200 230.3 200 208c0-30.93 25.07-56 56-56s56 25.07 56 56C312 230.3 298.9 249.4 280 258.4z"
              />
              <path
                d="M466.5 83.69l-192-80.01C269.6 1.656 261.3 0 256.1 0C250.8 0 242.5 1.656 237.6 3.688l-192 80.01C27.69 91.08 16 108.6 16 127.1C16 385.2 205.2 512 255.1 512C307.1 512 496 383.8 496 127.1C496 108.6 484.3 91.08 466.5 83.69zM280 258.4V328c0 13.25-10.75 24-24 24s-24-10.75-24-24V258.4C213.1 249.4 200 230.3 200 208c0-30.93 25.07-56 56-56s56 25.07 56 56C312 230.3 298.9 249.4 280 258.4z"
                fill="#34d399"
              />
            </svg>
            <h1 class="font-medium text-3xl">PrivacyProtect</h1>
          </div>
        </a>
      </header>
      <main>
        <div class="mb-3 prose prose-emerald max-w-none">
          <p>This page contains a secret, enter the password to reveal it.</p>
          <p>
            If a password hint is provided and you still cannot guess the
            password, contact the sender.
          </p>
          <p>
            The secret is safe; <strong>it never leaves your device</strong>. No
            internet connection required.
          </p>
        </div>

        <div class="overflow-hidden rounded-lg bg-gray-50 mb-4">
          <div class="px-4 py-5">
            <form>
              <div class="grid grid-cols-1 gap-y-4 gap-x-4 sm:grid-cols-6">
                <div class="sm:col-span-6">
                  <label for="pw">Password</label>
                  <div class="mt-1 flex rounded-md">
                    <input
                      autocomplete="on"
                      autofocus
                      class="input-border rounded-l-md flex-1 text-sm z-10"
                      id="pw"
                      name="pw"
                      required
                      spellcheck="false"
                      type="password"
                    />
                    <button
                      aria-label="Password show/hide toggle"
                      class="relative -ml-px inline-flex items-center rounded-r-md border border-gray-300 bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 focus:border-emerald-500 focus:outline-none focus:ring-1 focus:ring-emerald-500 focus-within:z-10"
                      onclick="togglePwVisibility(event)"
                      type="button"
                    >
                      <svg
                        id="pwShow"
                        class="h-4 w-4"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 576 512"
                      >
                        <path
                          d="M400 256C400 317.9 349.9 368 288 368C226.1 368 176 317.9 176 256C176 194.1 226.1 144 288 144C349.9 144 400 194.1 400 256zM288 160C234.1 160 192 202.1 192 256C192 309 234.1 352 288 352C341 352 384 309 384 256C384 202.1 341 160 288 160zM480.6 112.6C527.4 156 558.7 207.1 573.5 243.7C576.8 251.6 576.8 260.4 573.5 268.3C558.7 304 527.4 355.1 480.6 399.4C433.5 443.2 368.8 480 288 480C207.2 480 142.5 443.2 95.42 399.4C48.62 355.1 17.34 304 2.461 268.3C-.8205 260.4-.8205 251.6 2.461 243.7C17.34 207.1 48.62 156 95.42 112.6C142.5 68.84 207.2 32 288 32C368.8 32 433.5 68.84 480.6 112.6V112.6zM17.23 249.8C15.59 253.8 15.59 258.2 17.23 262.2C31.34 296 61.38 345.1 106.3 387.7C151.4 429.6 212.4 464 288 464C363.6 464 424.6 429.6 469.7 387.7C514.6 345.1 544.7 296 558.8 262.2C560.4 258.2 560.4 253.8 558.8 249.8C544.7 215.1 514.6 166 469.7 124.3C424.6 82.41 363.6 48 288 48C212.4 48 151.4 82.41 106.3 124.3C61.38 166 31.34 215.1 17.23 249.8V249.8z"
                        />
                      </svg>
                      <svg
                        id="pwHide"
                        class="hidden h-4 w-4"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 640 512"
                      >
                        <path
                          d="M636.1 497.7C640.4 500.5 641 505.5 638.3 508.1C635.5 512.4 630.5 513 627 510.3L3.022 14.26C-.4365 11.51-1.012 6.481 1.738 3.022C4.487-.4365 9.52-1.012 12.98 1.738L636.1 497.7zM605.5 268.3C595.9 291.3 579.5 321.1 556.5 351L543.1 341.1C566 312.4 581.7 283.1 590.8 262.2C592.4 258.2 592.4 253.8 590.8 249.8C576.7 215.1 546.6 166 501.7 124.3C456.6 82.41 395.6 47.1 319.1 47.1C277.9 47.1 240.3 58.69 207.4 75.4L193.7 64.55C229.9 44.92 272.2 31.1 320 31.1C400.8 31.1 465.5 68.84 512.6 112.6C559.4 156 590.7 207.1 605.5 243.7C608.8 251.6 608.8 260.4 605.5 268.3H605.5zM83.46 160.1L96.02 170.9C74 199.6 58.31 228 49.23 249.8C47.59 253.8 47.59 258.2 49.23 262.2C63.34 296 93.38 345.1 138.3 387.7C183.4 429.6 244.4 464 320 464C362.1 464 399.7 453.3 432.6 436.6L446.3 447.5C410.1 467.1 367.8 480 319.1 480C239.2 480 174.5 443.2 127.4 399.4C80.62 355.1 49.34 304 34.46 268.3C31.18 260.4 31.18 251.6 34.46 243.7C44.06 220.7 60.46 190.9 83.46 160.1H83.46zM208 259.4L225.5 273.1C233.6 317.1 272.8 352 320 352C321.8 352 323.5 351.1 325.2 351.9L342.7 365.7C335.4 367.2 327.8 368 320 368C259.3 368 209.8 319.7 208 259.4H208zM319.1 143.1C380.7 143.1 430.2 192.3 431.9 252.6L414.5 238.8C406.4 194 367.2 159.1 319.1 159.1C318.2 159.1 316.5 160 314.8 160.1L297.3 146.3C304.6 144.8 312.2 143.1 319.1 143.1L319.1 143.1z"
                        />
                      </svg>
                    </button>
                  </div>
                  <p class="mt-2 text-sm text-red-600" id="pwError"></p>
                </div>

                <div id="pwHintDiv" class="sm:col-span-6">
                  <label for="pwHint">Password hint</label>
                  <div class="my-1">
                    <textarea
                      class="input-border bg-gray-100 block w-full rounded-md text-sm resize-none"
                      id="pwHint"
                      name="pwHint"
                      readonly
                      rows="4"
                      spellcheck="false"
                    ></textarea>
                  </div>
                </div>
              </div>

              <div class="pt-5 flex justify-end">
                <button
                  class="bg-emerald-700 hover:bg-emerald-800 disabled:bg-gray-600 text-white inline-flex justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:cursor-not-allowed"
                  id="revealBtn"
                  onclick="revealSecret(event)"
                  type="submit"
                >
                  Reveal secret
                </button>
              </div>
            </form>
          </div>
        </div>

        <label for="message">Result</label>
        <div class="my-1">
          <textarea
            class="input-border bg-gray-100 block w-full rounded-md text-sm resize-none"
            id="message"
            name="message"
            readonly
            rows="4"
            spellcheck="false"
          ></textarea>
          <img
            alt="Revealed image"
            class="hidden max-h-96 mb-4 rounded-md"
            id="img"
          />
          <a
            class="flex items-center text-sm font-medium text-gray-800 transition hover:text-emerald-600"
            download="privacyprotect.html"
            href="#"
            id="file"
          >
            <button
              class="hidden bg-emerald-700 hover:bg-emerald-800 disabled:bg-gray-600 text-white inline-flex justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:cursor-not-allowed"
              id="saveBtn"
            ></button
          ></a>
        </div>
      </main>
    </div>
  </body>
</html>
